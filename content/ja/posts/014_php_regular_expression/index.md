+++
date = '2025-05-12T17:23:41+09:00'
draft = false
title = 'PHPと正規表現'
categories = ["PHP"]
+++


PHPでは、**郵便番号（例：123-4567）**の形式を正規表現で簡潔に判定することができます。この記事ではその方法を紹介しつつ、正規表現で頻出する記号や構文も一覧でまとめています。

## ✅ 郵便番号の形式を判定する正規表現

```php
$pattern = '/^\d{3}-\d{4}$/u';
```

この正規表現は、「数字3桁 + ハイフン + 数字4桁」の形式に完全一致するかどうかをチェックします。

解説（1つずつの記号の意味）

| 記号      | 説明                                            |
| ------- | --------------------------------------------- |
| `/.../` | 正規表現の開始と終了を示すデリミタ（PHPでは通常スラッシュ）               |
| `^`     | 文字列の先頭を意味します（これがないと途中の一致でもマッチしてしまう）           |
| `\d`    | 数字（0〜9）の1文字に一致します                             |
| `{3}`   | 直前のパターン（ここでは`\d`）を3回繰り返す                      |
| `-`     | ハイフン（リテラル文字なのでエスケープ不要）                        |
| `{4}`   | 直前のパターン（`\d`）を4回繰り返す                          |
| `$`     | 文字列の末尾を意味します                                  |
| `u`     | 修飾子。UTF-8モードでマルチバイト文字（日本語など）を正しく扱えるようにするために必要 |



💡 実際のコード例


```php

$zipcode = '123-4567';

if (preg_match('/^\d{3}-\d{4}$/u', $zipcode)) {
    echo "有効な郵便番号です。";
} else {
    echo "無効な郵便番号です。";
}

```



## 📘 正規表現でよく使われるパターン一覧

| パターン      | 説明                                  | 例                                                                                  |
| --------- | ----------------------------------- | ---------------------------------------------------------------------------------- |
| `.`       | 任意の1文字（改行を除く）                       | `a.b` → `acb`, `arb` にマッチ                                                          |
| `^`       | 行の先頭に一致                             | `^abc` → `abc123` にマッチ                                                             |
| `$`       | 行の末尾に一致                             | `abc$` → `123abc` にマッチ                                                             |
| `*`       | 直前の文字が0回以上出現                        | `a*` → `""`, `"a"`, `"aaa"` にマッチ                                                   |
| `+`       | 直前の文字が1回以上出現                        | `a+` → `"a"`, `"aaa"` にマッチ                                                         |
| `?`       | 直前の文字が0回または1回出現                     | `a?` → `"a"` または `""` にマッチ                                                         |
| `{n}`     | 直前の文字を n 回繰り返す                      | `\d{4}` → `1234` にマッチ                                                              |
| `{n,}`    | 直前の文字を n 回以上繰り返す                    | `a{2,}` → `"aa"`, `"aaa"` にマッチ                                                     |
| `{n,m}`   | 直前の文字を n〜m 回繰り返す                    | `a{2,4}` → `"aa"`, `"aaa"` にマッチ                                                    |
| `[abc]`   | `a`, `b`, `c` のいずれか1文字に一致           | `a`, `b`, `c` にマッチ                                                                 |
| `[^abc]`  | `a`, `b`, `c` 以外の1文字に一致             | `d`, `x` などにマッチ                                                                    |
| `[0-9]`   | `0〜9` の数字に一致                        | `5` にマッチ                                                                           |
| `[a-z]`   | 小文字 a〜z に一致                         | `m` にマッチ                                                                           |
| `[A-Z]`   | 大文字 A〜Z に一致                         | `Z` にマッチ                                                                           |
| `\d`      | 数字1文字（`[0-9]` と同じ）                  | `7` にマッチ                                                                           |
| `\D`      | 数字以外の1文字（`[^0-9]` と同じ）              | `a`, `-` などにマッチ                                                                    |
| `\w`      | 英数字またはアンダースコア（`[a-zA-Z0-9_]`）       | `a`, `_`, `9` にマッチ                                                                 |
| `\W`      | 上記以外の1文字（英数字・アンダースコア以外）             | `-`, `@` にマッチ                                                                      |
| `\s`      | 空白文字（スペース、タブ、改行など）                  | `" "`, `\t`, `\n` にマッチ                                                             |
| `\S`      | 空白以外の文字                             | `a`, `1` にマッチ                                                                      |
| `\|`      | OR条件（左右どちらかに一致） <br>通常はグループ化と併用 | `abc\|xyz` → `abc`, `xyz` に一致<br>`(dog\|cat)s?` → `dog`, `dogs`, `cat`, `cats` に一致 |
| `( ... )` | グループ化（繰り返しや先読みなどに使う）                | `(ab)+` → `abab` にマッチ                                                              |
| `(?i)`    | 大文字・小文字を区別しないモード                    | `(?i)abc` → `abc`, `ABC` に一致                                                       |
| `(?=...)` | 肯定の先読み（後ろに特定の文字列が**続く**場合にマッチ）   | `\d(?=円)` → `"100円"` のうち、`円` の**直前の数字** `0` にマッチ |
| `(?!...)` | 否定の先読み（後ろに特定の文字列が**続かない**場合にマッチ） | `\d(?!円)` → `"100ドル"` のうち、`円` **以外**が続く `0` にマッチ |




## 🧩 修飾子（modifiers）の代表例

| 修飾子 | 説明                          |
| --- | --------------------------- |
| `i` | 大文字・小文字を区別しない               |
| `m` | 複数行モード：^や\$が行の先頭・末尾にもマッチする  |
| `s` | `.` を改行にもマッチさせる             |
| `u` | UTF-8モード：マルチバイト文字を正しく扱える    |
| `x` | 空白やコメントを無視する（複雑な正規表現の可読性向上） |
